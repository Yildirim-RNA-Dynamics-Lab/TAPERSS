Combinatorial Method for RNA structure Prediction. Written in C++.
Developed by Ivan Riveros in part using code from Kye Won Wang as a guide.

Note: It is NOT recommended to test systems larger than 6 nucleotides long. Run time varies based on sequence and hardware, but a 7 long sequence will likely take at minimum a full week to complete, and will likely generate gigabytes to terabytes of output data.

To compile the code: From the CombinatorialRNA directory run 'make'.
Inside the makefile file, you may specify the compiler to use with the "CC =" option. This code has only been tested with clang and g++. Compilation with clang has shown slightly better performance. Ensure the compiler used is up to date with the latest version, or at least supports the "std=c++17" option.

How to use:
To run with an input file:
./bin/TAPERSS -i [FILE]
How to format the input file
                                OPTION1 = [SELECTION1]
                                OPTION2 = [SELECTION2]
Example input shown in ./docs/ExampleInput.txt. All options are case-insensitive.

Below are the options for the input file.

Options:
    SEQUENCE        Give the sequence to perform the specified action.
    OUTPUT-FILE     Specify the output file name.
		WRITE-COORDINATES If equal to "TRUE", output file will be formatted as a PDB file with all coordinates written for each structure generated. If "FALSE", only the index set, energy and structure filter RMSD values will be written for each structure generated.
    RUN-TYPE        Select action to be taken.
                        Available actions:
                                "combinatorial" - Perform combinatorial run
                                "from-index" - Create a single structure from sequence and given index
                                "idx-list" - Build several structures from an index list file, where the file contains several index sets (formatted as 1-1-1-1), where each index is separated by a newline.
    SINGLE-INDEX-LIST         Indices in form "0-0-0-0-0" to be used with "from-index" action. 
    INDEX-LIST-FILE Specify the input file to be used with "idx-list" action.
		SECONDARY-STRUCTURE-FILTER (Optional) Specifiy a structure filter in dot-bracket notation. Only accepts "(" and ".". Example, to filter for a tetraloop when studing a hexamer use notation: (....)
    OVERLAP-RMSD-LIMIT Set RMSD cutoff value for overlapped dinucleotides.
    WATSON-CRICK-OVERLAP-LIMIT  Set RMSD cutoff value for the structure filter. 
    LIBRARY-PROTOTYPE         Define a library file prototype. Give the location/filename of any library file but replace the dinucleotide sequence with XX. The program will search for any files with that name as needed.
                        Example: ./LIBRARY_FILES/AA_library_combined.txt => ./LIBRARY_FILES/XX_library_combined.txt
    WATSON-CRICK-LIBARY-PROTOTYPE Same as the library option but for any Watson-Crick Libraries.
		STRUCTURE-COUNT-LIMIT-TYPE (Optional) Select the type of build limit (if any)
													Available Options:
																	"energy" - All structures will be built as normal, but only the lowest energy structures will be saved to file, based on the structure-count-limit option.
																	"blind" - Once structure-count-limit structures are built, the calculation will stop. This option obeys the structure-filter, so if it is set, it will stop once N structures which pass the filter are built.
		STRUCTURE-COUNT-LIMIT (Optional) Specifiy the total number of structures to by saved based on structure-count-limit-type option.

To run using flags (Note library file prototype must be defined in the input file):
./bin/TAPERSS -[flag] [option]
Below are the available flags. You may use both the inputfile and normal flags. Any conflicting options will be overwritten by whichever is specified last.
Flags:
		-i	[FILE]			Use to specify the input file (described above).
    -o  [FILE]      Specify output file to write to.
    -s  [SEQUENCE]      Sequence to use in performing action
    -c                  Include to write PDB formatted output.
		--run-type [ACTION]	Specify the action to take. Same as RUN-TYPE described above
		--index [INDEX]    	Specify index to use with "idx" option selected.
		--index-list [FILE] Specify index file to use with "idx-list" option selected.
		--rmsd-lim [DECIMAL VALUE] Same as OVERLAP-RMSD-LIMIT.
		--wc-rmsd-lim [DECIMAL VALUE] Same as WATSON-CRICK-OVERLAP-LIMIT.
		--secondary-structure-filter [DOT-BRACKET] Same as SECONDARY-STRUCTURE-FILTER.
		--lib-prototype [PROTOTYPE] Same as LIBRARY-PROTOTYPE described above.
		--wc-lib-prototype [PROTOTYPE] Same as WATSON-CRICK-LIBRARY-PROTOTYPE described above.
		--str-count-limit-type [TYPE] Same as STRUCTURE-COUNT-LIMIT-TYPE.
		--str-count-limit [INTEGER] Same as STRUCTURE-COUNT-LIMIT.
		

